<!DOCTYPE html><html><head><meta charset="UTF-8"><link media="screen,projection" href="contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="css/moose.css" type="text/css" rel="stylesheet"></link><script src="contrib/jquery/jquery.min.js" type="text/javascript"></script><script src="contrib/materialize/materialize.min.js" type="text/javascript"></script><script src="contrib/clipboard/clipboard.min.js" type="text/javascript"></script><script src="contrib/prism/prism.min.js" type="text/javascript"></script><script src="contrib/katex/katex.min.js" type="text/javascript"></script><script src="contrib/fuse/fuse.min.js" type="text/javascript"></script><script src="js/search_index.js" type="text/javascript"></script><script src="js/init.js" type="text/javascript"></script><title>Three - dimensional   examples|Numbat</title><script src="contrib/plotly/plotly.min.js" type="text/javascript"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://github.com/cpgr/numbat" class="right"><img src="media/github-logo.png" class="github-mark"></img><img src="media/github-mark.png" class="github-logo"></img></a><a href="http://cpgr.github.io/numbat/" class="left moose-logo">Numbat</a><ul class="right hide-on-med-and-down" id="nav-mobile"><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="086064c0-b467-4702-bd97-b193c4fc0612">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="5bcb36d4-565a-46fa-a6d2-ab86bd8a7062">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="7631e4c4-6ffc-4586-8592-f2be1e84d304">Details<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="bae02496-9ae7-49b0-9bbc-218310abb225">Examples<i class="material-icons right">arrow_drop_down</i></a></li><li><a data-constrainWidth="false" href="#!" class="dropdown-button" data-activates="f3dc0b2d-2fd2-491b-bcd4-467d88bf9f51">Manual<i class="material-icons right">arrow_drop_down</i></a></li></ul><ul class="dropdown-content" id="086064c0-b467-4702-bd97-b193c4fc0612"><li><a href="getting_started.html">Installation</a></li></ul><ul class="dropdown-content" id="5bcb36d4-565a-46fa-a6d2-ab86bd8a7062"><li><a href="introduction.html">Introduction</a></li><li><a href="governing_equations.html">Governing equations</a></li></ul><ul class="dropdown-content" id="7631e4c4-6ffc-4586-8592-f2be1e84d304"><li><a href="implementation.html">Implementation</a></li><li><a href="input_file_syntax.html">Input file syntax</a></li><li><a href="running_numbat.html">Running Numbat</a></li><li><a href="systems.html">Available objects</a></li></ul><ul class="dropdown-content" id="bae02496-9ae7-49b0-9bbc-218310abb225"><li><a href="example2D.html">2D</a></li><li><a href="example3D.html">3D</a></li></ul><ul class="dropdown-content" id="f3dc0b2d-2fd2-491b-bcd4-467d88bf9f51"><li><a href="download.html">User manual</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input autocomplete="off" onkeyup="mooseSearch()" type="text" id="moose-search-box"><label for="search">http://cpgr.github.io/numbat/</label></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-action modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="example3D.html" class="breadcrumb">example3D</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section data-section-text="Three - dimensional   examples" data-section-level="1" id="bff9fe7d-3f74-4dc7-bc59-e9fd2612ce77"><h1>Three-dimensional examples</h1><p>Complete input files for 2D models using the dimensional and dimensionless streamfunction formulations are provided, for both isotropic and anisotropic porous media. These examples are provided in the Numbat <em>examples</em> folder.</p><section class="scrollspy" data-section-text="Isotropic   models" data-section-level="2" id="6c6f8baa-8686-4238-9f9a-9caa80d64d9e"><h2>Isotropic models</h2><p>The first examples are for an isotropic porous medium (<span class="moose-katex-inline-equation" id="moose-equation-92671c6a-089f-4326-b66b-ee86f22f862e"><script>var element = document.getElementById("moose-equation-92671c6a-089f-4326-b66b-ee86f22f862e");katex.render("\\gamma = 1", element, {displayMode:false,throwOnError:false});</script></span>).</p><section data-section-text="Input   file" data-section-level="3" id="e65119e3-4be9-49e2-8551-709f51a0d187"><h3>Input file</h3><p>The complete input file for this problem is</p><div class="card"><div class="card-content"><pre style="max-height:350px;"><code class="language-text"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
  refined_edge = front
  refined_resolution = 0.001
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]</code></pre><a data-position="top" href="#ea959cbf-4833-4179-b757-01b11a43dd67" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/3Dddc.i">(examples/3D/isotropic/3Dddc.i)</a></div></div></section><section data-section-text="Running   the   example" data-section-level="3" id="8f4dba82-51c6-4bb5-9d15-402e6f7ecf73"><h3>Running the example</h3><div class="card moose-alert moose-alert-note"><div class="card-content"><div class="moose-alert-title card-title"><span class="moose-alert-title-brand">note</span></div><div class="moose-alert-content"><p></p></div></div></div><p>Examples of the total run times for this problem on a cluster are over 27 hours for a single processor down to only 30 minutes using 100 processors in parallel.</p></section><section data-section-text="Results" data-section-level="3" id="90dd145c-deb9-43ee-9319-2638d209da86"><h3>Results</h3><p>This 3D example should produce a concentration profile similar to that presented in <a class="tooltipped" href="#fig:3D" data-tooltip="#fig:3D" data-position="top">Figure 1</a>, where several downwelling plumes of high concentration can be observed:</p><div style="width:80%;margin-left:10px" id="fig:3D" class="card"><div class="card-image"><img src="media/3D.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text">3D concentration profile</span></p></div></div><p>Note that due to the random perturbation applied to the initial concentration profile, the geometry of the concentration profile obtained will differ from run to run.</p><p>The flux over the top surface is of particular interest in many cases (especially convective mixing of CO<span class="moose-katex-inline-equation" id="moose-equation-84c23bfb-34aa-49d1-b22e-f2ca1520e6d7"><script>var element = document.getElementById("moose-equation-84c23bfb-34aa-49d1-b22e-f2ca1520e6d7");katex.render("_2", element, {displayMode:false,throwOnError:false});</script></span>). This is calculated in this example file using the <a data-position="top" href="source/postprocessors/NumbatSideFlux.html" class="tooltipped" data-tooltip="source/postprocessors/NumbatSideFlux.html">NumbatSideFlux</a> in the input file, and presented in <a class="tooltipped" href="#fig:3Dflux" data-tooltip="#fig:3Dflux" data-position="top">Figure 2</a>.</p><div style="width:80%;margin-left:10px" id="fig:3Dflux" class="card"><div class="card-image"><img src="media/3Dflux.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text">3D flux across the top boundary</span></p></div></div><p>Initially, the flux is purely diffusive, and scales as <span class="moose-katex-inline-equation" id="moose-equation-4d46b7ed-8f70-4db3-a997-bcb14168e1f3"><script>var element = document.getElementById("moose-equation-4d46b7ed-8f70-4db3-a997-bcb14168e1f3");katex.render("1 / \\sqrt(\\pi t)", element, {displayMode:false,throwOnError:false});</script></span>, where <span class="moose-katex-inline-equation" id="moose-equation-7ff1475c-5db4-4bc3-b675-589c5bfebe07"><script>var element = document.getElementById("moose-equation-7ff1475c-5db4-4bc3-b675-589c5bfebe07");katex.render("t", element, {displayMode:false,throwOnError:false});</script></span> is time (shown as the dashed green line). After some time, the convective instability becomes sufficiently strong, at which point the flux across the top boundary rapidly increases (at a time of approximately 1,700 seconds). Also shown for comparison is the flux for the 2D example. It is apparent that the 3D model leads in a slower onset of convection (the time where the flux first increases from the diffusive rate).</p></section></section><section class="scrollspy" data-section-text="Large   model" data-section-level="2" id="5ec1732b-3cc1-4c2d-9337-e58c3e9b35f4"><h2>Large model</h2><p>Increasing the size of the mesh enables more of the flow regimes to be modelled (at the cost of increased computational expense). Consider a dimensionless model with Rayleigh number <span class="moose-katex-inline-equation" id="moose-equation-8d0f7cd6-a62b-426a-9d78-af69bc2435aa"><script>var element = document.getElementById("moose-equation-8d0f7cd6-a62b-426a-9d78-af69bc2435aa");katex.render("Ra = 5000", element, {displayMode:false,throwOnError:false});</script></span>. Lateral model dimensions are chosen so that approximately twenty fingers in the lateral directions are present at the onset of convection.</p><p>A suitable fully unstructured mesh for this model that is sufficiently refined near the top boundary with increasing element size with depth to minimise the number of elements can be constructed in an external meshing code. In this example, the open-source mesh generator <a href="http://www.gmsh.info" data-tooltip="http://www.gmsh.info" data-position="top" class="tooltipped">Gmsh</a> is used. The following geometry file describes the dimensions of the model and the target resolutions.</p><div class="card"><div class="card-content"><pre style="max-height:350px;"><code class="language-text">// Gmsh geometry file for a 3D mesh corresponding to
// Ra = 5000 (dimensionless model).
// The mesh is refined at the top boundary with element
// size increasing with depth.
//
// This geometry file can be converted to a mesh using
// gmsh -3 Ra5000.geo

// Mesh width in each dimension
xmax = 2000;
ymax = 2000;
zmax = 5000;

// Resolution at the top and bottom
lctop = 10;
lcbot = 200;

// Vertices of mesh
Point(1) = {0, 0, 0, lcbot};
Point(2) = {xmax, 0, 0, lcbot};
Point(3) = {0, ymax, 0, lcbot};
Point(4) = {xmax, ymax, 0, lcbot};
Point(5) = {xmax, ymax, zmax, lctop};
Point(6) = {xmax, 0, zmax, lctop};
Point(7) = {0, ymax, zmax, lctop};
Point(8) = {0, 0, zmax, lctop};

// Lines connecting vertices
Line(1) = {3, 7};
Line(2) = {7, 5};
Line(3) = {5, 4};
Line(4) = {4, 3};
Line(5) = {3, 1};
Line(6) = {2, 4};
Line(7) = {2, 6};
Line(8) = {6, 8};
Line(9) = {8, 1};
Line(10) = {1, 2};
Line(11) = {8, 7};
Line(12) = {6, 5};

// Surfaces defined by lines
Line Loop(13) = {7, 8, 9, 10};
Plane Surface(14) = {13};
Line Loop(15) = {6, 4, 5, 10};
Plane Surface(16) = {15};
Line Loop(17) = {3, 4, 1, 2};
Plane Surface(18) = {17};
Line Loop(19) = {12, -2, -11, -8};
Plane Surface(20) = {19};
Line Loop(21) = {7, 12, 3, -6};
Plane Surface(22) = {21};
Line Loop(23) = {9, -5, 1, -11};
Plane Surface(24) = {23};
Surface Loop(25) = {14, 22, 20, 18, 16, 24};

// Volume defined by surfaces
Volume(26) = {25};

// Make the sides suitable for periodic boundary conditions
Periodic Surface {18} = {14} Translate {0, ymax, 0};
Periodic Surface {22} = {24} Translate {xmax, 0, 0};

// Name the faces for easy application of boundary conditions
Physical Surface(&quot;top&quot;) = {20};
Physical Surface(&quot;bottom&quot;) = {16};
Physical Surface(&quot;front&quot;) = {14};
Physical Surface(&quot;back&quot;) = {18};
Physical Surface(&quot;left&quot;) = {24};
Physical Surface(&quot;right&quot;) = {22};
Physical Volume(&quot;0&quot;) = {26};</code></pre><a data-position="top" href="#ab9600f8-a722-4a1f-a5b2-f409b63d7037" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/Ra5000.geo">(examples/3D/isotropic/Ra5000.geo)</a></div></div><p>This mesh geometry file can be used to generate a mesh using Gmsh, either through its graphical user interface, or alternatively, on the commandline</p><pre><code class="language-bash">
gmsh -3 Ra5000.geo
</code></pre><p>which results in a mesh file with approximately 8.4 million tetrahedral elements.</p><section data-section-text="Input   file" data-section-level="3" id="45d359d2-f119-42ba-934e-002806b5094e"><h3>Input file</h3><p>The complete input file for this problem is</p><div class="card"><div class="card-content"><pre style="max-height:350px;"><code class="language-text"># Density-driven convective mixing in a 3D model using the streamfunction
# formulation for Ra = 5000
#
# Uses an unstructured mesh generated by Gmsh
# To generate the mesh, run 'gmsh -3 Ra5000.geo'
#
# Note: this mesh has approximately 8.4 million elements and takes about
# 8 hours to run using 200 processors

[Mesh]
  type = FileMesh
  file = Ra5000.e
[]

[Numbat]
  [./Dimensionless]
  [../]
[]

[ICs]
  [./concentration]
    type = NumbatPerturbationIC
    variable = concentration
    amplitude = 0.1
    seed = 1
  [../]
  [./streamfunctionx]
    type = ConstantIC
    variable = streamfunction_x
    value = 0.0
  [../]
  [./streamfunctiony]
    type = ConstantIC
    variable = streamfunction_y
    value = 0.0
  [../]
[]

[Executioner]
  type = Transient
  end_time = 6e4
  start_time = 1
  solve_type = NEWTON
  nl_abs_tol = 1e-9
  l_max_its = 200
  [./TimeStepper]
    type = FunctionDT
    interpolate = false
    time_t = '0 10 500 1e3 1e4 6e4'
    time_dt = '9 10 50 100 200 200'
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options = -snes_ksp_ew
    petsc_options_iname = '-ksp_type -pc_type -pc_asm_overlap -sub_pc_type -pc_factor_levels -ksp_atol'
    petsc_options_value = 'gmres asm 10 ilu 4 1e-12'
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
    output_linear = true
  [../]
  [./exodus]
    type = Exodus
    execute_on = 'INITIAL TIMESTEP_END'
    interval = 4
  [../]
  [./csvoutput]
    type = CSV
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./checkpoint]
    type = Checkpoint
    num_files = 2
    interval = 10
  [../]
[]</code></pre><a data-position="top" href="#680acb58-fd27-4b48-9271-7818b1e41c72" class="tooltipped modal-trigger" data-tooltip="/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/3DddcSF_Ra5000.i">(examples/3D/isotropic/3DddcSF_Ra5000.i)</a></div></div><p>An example of the evolution of the convective fingers in this model are presented in <a class="tooltipped" href="#fig:3Da" data-tooltip="#fig:3Da" data-position="top">Figure 3</a> and <a class="tooltipped" href="#fig:3Db" data-tooltip="#fig:3Db" data-position="top">Figure 4</a> for an isotropic model. The concentration profile just after the onset of convection is shown in <a class="tooltipped" href="#fig:3Da" data-tooltip="#fig:3Da" data-position="top">Figure 3</a> for a dimensionless time <span class="moose-katex-inline-equation" id="moose-equation-37aaceda-b4e9-4ea7-bb4c-51ecd6452156"><script>var element = document.getElementById("moose-equation-37aaceda-b4e9-4ea7-bb4c-51ecd6452156");katex.render("t = 1400", element, {displayMode:false,throwOnError:false});</script></span>. As the isosurface shows, there are a large number of small fingers at this stage. As time increases, these small structures merge, forming larger fingers in a process that continues as time proceeds, until only a few large fingers are present, see <a class="tooltipped" href="#fig:3Db" data-tooltip="#fig:3Db" data-position="top">Figure 4</a>. This merging behaviour is very complicated and difficult to characterise in any quantitative manner</p><div style="width:80%;margin-left:10px" id="fig:3Da" class="card"><div class="card-image"><img src="media/3Da.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 3: </span><span class="moose-caption-text">Evolution of convective mixing in 3D. Time is dimensionless.</span></p></div></div><div style="width:80%;margin-left:10px" id="fig:3Db" class="card"><div class="card-image"><img src="media/3Db.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 4: </span><span class="moose-caption-text">Evolution of convective mixing in 3D (continued). Time is dimensionless.</span></p></div></div><p>Many interesting observations can be made from large-scale 3D models. For example, the temporal evolution of the fingers shown in <a class="tooltipped" href="#fig:3Da" data-tooltip="#fig:3Da" data-position="top">Figure 3</a> and <a class="tooltipped" href="#fig:3Db" data-tooltip="#fig:3Db" data-position="top">Figure 4</a> can also be examined through a horizontal slice through the model, see <a class="tooltipped" href="#fig:slices" data-tooltip="#fig:slices" data-position="top">Figure 5</a>. In this example, a horizontal slice is taken at a dimensionless distance of 100 from the top surface (where the CO<span class="moose-katex-inline-equation" id="moose-equation-44d9c374-57df-48ed-804b-4cb76067ce79"><script>var element = document.getElementById("moose-equation-44d9c374-57df-48ed-804b-4cb76067ce79");katex.render("_2", element, {displayMode:false,throwOnError:false});</script></span> concentration is 1). As the fingers approach this depth, they are initially observed as circular regions of higher concentration, cf <a class="tooltipped" href="#fig:slices" data-tooltip="#fig:slices" data-position="top">Figure 5</a> (a) and (b), where we can see that the fingers have just reached this depth at dimensionless time 1000. As time increases, the complexity of the fingering process can be observed, with merging of adjacent fingers and growth observed. Like <a href="#pau2010">Pau et al. (2010)</a> and <a href="#fu2013">Fu et al. (2013)</a>, we observe that the fingers arrange themselves into polygonal structures with thin profiles surrounded by large regions of unsaturated fluid, see <a class="tooltipped" href="#fig:slices" data-tooltip="#fig:slices" data-position="top">Figure 5</a> (d), (e) and (f).</p><div style="width:90%;margin-left:10px" id="fig:slices" class="card"><div class="card-image"><img src="media/slices.png" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-heading">Figure 5: </span><span class="moose-caption-text">Horizontal slice at dimensionless depth 10 showing the evolution of the convective fingers in 3D. Time increasing from (a) to (f).</span></p></div></div></section></section><section class="scrollspy" data-section-text="References" data-section-level="2" id="f4f117ce-0fda-4fa3-af78-8027cc60c7bc"><h2>References</h2><ol class="moose-bibliogrpahy"><li id="fu2013">Xiaojing Fu, Luis Cueto-Felgueroso, and Ruben Juanes.
Pattern formation and coarsening dynamics in three-dimensional convective mixing in porous media.
<em>Phil. Trans. R. Soc. A</em>, 371:20120355, 2013.<a style="padding-left:10px;" href="#76dafacf-d219-424c-a28c-8b2e81ecf2f9" class="modal-trigger moose-bibtex-modal">[BibTeX]</a><div id="76dafacf-d219-424c-a28c-8b2e81ecf2f9" class="modal"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{fu2013,
    author = "Fu, Xiaojing and Cueto-Felgueroso, Luis and Juanes, Ruben",
    title = "Pattern formation and coarsening dynamics in three-dimensional convective mixing in porous media",
    journal = "Phil. Trans. R. Soc. A",
    volume = "371",
    pages = "20120355",
    year = "2013"
}
</code></pre></div></div></li><li id="pau2010">George&nbsp;SH Pau, John&nbsp;B Bell, Karsten Pruess, Ann&nbsp;S Almgren, Michael&nbsp;J Lijewski, and Keni Zhang.
<span class="bibtex-protected">High-resolution simulation and characterization of density-driven flow in CO$_2$ storage in saline aquifers</span>.
<em>Advances in Water Resources</em>, 33:443â€“455, 2010.<a style="padding-left:10px;" href="#fee85f1a-06df-41f2-a5a6-3d4fa6747be8" class="modal-trigger moose-bibtex-modal">[BibTeX]</a><div id="fee85f1a-06df-41f2-a5a6-3d4fa6747be8" class="modal"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{pau2010,
    author = "Pau, George SH and Bell, John B and Pruess, Karsten and Almgren, Ann S and Lijewski, Michael J and Zhang, Keni",
    title = "{High-resolution simulation and characterization of density-driven flow in CO$\_2$ storage in saline aquifers}",
    journal = "Advances in Water Resources",
    volume = "33",
    pages = "443--455",
    year = "2010"
}
</code></pre></div></div></li></ol></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a data-delay="1000" data-position="left" href="#6c6f8baa-8686-4238-9f9a-9caa80d64d9e" class="tooltipped" data-tooltip="Isotropic   models">Isotropic   models</a></li><li><a data-delay="1000" data-position="left" href="#5ec1732b-3cc1-4c2d-9337-e58c3e9b35f4" class="tooltipped" data-tooltip="Large   model">Large   model</a></li><li><a data-delay="1000" data-position="left" href="#f4f117ce-0fda-4fa3-af78-8027cc60c7bc" class="tooltipped" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div><div id="ea959cbf-4833-4179-b757-01b11a43dd67" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/3Dddc.i</h4><pre><code class="language-text"># 3D density-driven convective mixing. Instability is seeded by small perturbation
# to porosity. Don't try this on a laptop!

[Mesh]
  type = NumbatBiasedMesh
  dim = 3
  zmax = 1.5
  nx = 20
  ny = 20
  nz = 500
  refined_edge = front
  refined_resolution = 0.001
[]

[Variables]
  [./concentration]
    initial_condition = 0
    scaling = 1e6
  [../]
  [./pressure]
    initial_condition = 1e6
  [../]
[]

[AuxVariables]
  [./noise]
    family = MONOMIAL
    order = CONSTANT
  [../]
[]

[ICs]
  [./noise]
    type = RandomIC
    variable = noise
    max = 0.003
    min = -0.003
  [../]
[]

[Materials]
  [./porosity]
    type = NumbatPorosity
    porosity = 0.3
    noise = noise
  [../]
  [./permeability]
    type = NumbatPermeability
    permeability = '1e-11 0 0 0 1e-11 0 0 0 1e-11'
  [../]
  [./diffusivity]
    type = NumbatDiffusivity
    diffusivity = 2e-9
  [../]
  [./density]
    type = NumbatDensity
    concentration = concentration
    zero_density = 995
    delta_density = 10.5
    saturated_concentration = 0.049306
  [../]
  [./viscosity]
    type = NumbatViscosity
    viscosity = 6e-4
  [../]
[]

[Kernels]
  [./time]
    type = NumbatTimeDerivative
    variable = concentration
  [../]
  [./diffusion]
    type = NumbatDiffusion
    variable = concentration
  [../]
  [./convection]
    type = NumbatConvection
    variable = concentration
    pressure = pressure
  [../]
  [./darcy]
    type = NumbatDarcy
    variable = pressure
    concentration = concentration
  [../]
[]

[BCs]
  [./conctop]
    type = PresetBC
    variable = concentration
    boundary = front
    value = 0.049306
  [../]
  [./Periodic]
    [./x]
      variable = concentration
      auto_direction = 'x y'
    [../]
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  l_max_its = 200
  end_time = 3e5
  solve_type = NEWTON
  petsc_options = -ksp_snes_ew
  petsc_options_iname = '-pc_type -sub_pc_type -ksp_atol'
  petsc_options_value = 'bjacobi ilu 1e-12'
  nl_abs_tol = 1e-10
  nl_max_its = 25
  dtmax = 2e3
  [./TimeStepper]
    type = IterationAdaptiveDT
    dt = 1
  [../]
[]

[Postprocessors]
  [./boundaryfluxint]
    type = NumbatSideFlux
    variable = concentration
    boundary = top
  [../]
  [./mass]
    type = NumbatTotalMass
    variable = concentration
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
  [../]
  [./exodus]
    type = Exodus
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./csvoutput]
    type = CSV
    file_base = 3Dddc
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
[]
</code></pre></div></div><div id="ab9600f8-a722-4a1f-a5b2-f409b63d7037" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/Ra5000.geo</h4><pre><code class="language-text">// Gmsh geometry file for a 3D mesh corresponding to
// Ra = 5000 (dimensionless model).
// The mesh is refined at the top boundary with element
// size increasing with depth.
//
// This geometry file can be converted to a mesh using
// gmsh -3 Ra5000.geo

// Mesh width in each dimension
xmax = 2000;
ymax = 2000;
zmax = 5000;

// Resolution at the top and bottom
lctop = 10;
lcbot = 200;

// Vertices of mesh
Point(1) = {0, 0, 0, lcbot};
Point(2) = {xmax, 0, 0, lcbot};
Point(3) = {0, ymax, 0, lcbot};
Point(4) = {xmax, ymax, 0, lcbot};
Point(5) = {xmax, ymax, zmax, lctop};
Point(6) = {xmax, 0, zmax, lctop};
Point(7) = {0, ymax, zmax, lctop};
Point(8) = {0, 0, zmax, lctop};

// Lines connecting vertices
Line(1) = {3, 7};
Line(2) = {7, 5};
Line(3) = {5, 4};
Line(4) = {4, 3};
Line(5) = {3, 1};
Line(6) = {2, 4};
Line(7) = {2, 6};
Line(8) = {6, 8};
Line(9) = {8, 1};
Line(10) = {1, 2};
Line(11) = {8, 7};
Line(12) = {6, 5};

// Surfaces defined by lines
Line Loop(13) = {7, 8, 9, 10};
Plane Surface(14) = {13};
Line Loop(15) = {6, 4, 5, 10};
Plane Surface(16) = {15};
Line Loop(17) = {3, 4, 1, 2};
Plane Surface(18) = {17};
Line Loop(19) = {12, -2, -11, -8};
Plane Surface(20) = {19};
Line Loop(21) = {7, 12, 3, -6};
Plane Surface(22) = {21};
Line Loop(23) = {9, -5, 1, -11};
Plane Surface(24) = {23};
Surface Loop(25) = {14, 22, 20, 18, 16, 24};

// Volume defined by surfaces
Volume(26) = {25};

// Make the sides suitable for periodic boundary conditions
Periodic Surface {18} = {14} Translate {0, ymax, 0};
Periodic Surface {22} = {24} Translate {xmax, 0, 0};

// Name the faces for easy application of boundary conditions
Physical Surface(&quot;top&quot;) = {20};
Physical Surface(&quot;bottom&quot;) = {16};
Physical Surface(&quot;front&quot;) = {14};
Physical Surface(&quot;back&quot;) = {18};
Physical Surface(&quot;left&quot;) = {24};
Physical Surface(&quot;right&quot;) = {22};
Physical Volume(&quot;0&quot;) = {26};
</code></pre></div></div><div id="680acb58-fd27-4b48-9271-7818b1e41c72" class="modal bottom-sheet"><div class="modal-content"><h4>/Users/gre462/Documents/MOOSE/projects/numbat/examples/3D/isotropic/3DddcSF_Ra5000.i</h4><pre><code class="language-text"># Density-driven convective mixing in a 3D model using the streamfunction
# formulation for Ra = 5000
#
# Uses an unstructured mesh generated by Gmsh
# To generate the mesh, run 'gmsh -3 Ra5000.geo'
#
# Note: this mesh has approximately 8.4 million elements and takes about
# 8 hours to run using 200 processors

[Mesh]
  type = FileMesh
  file = Ra5000.e
[]

[Numbat]
  [./Dimensionless]
  [../]
[]

[ICs]
  [./concentration]
    type = NumbatPerturbationIC
    variable = concentration
    amplitude = 0.1
    seed = 1
  [../]
  [./streamfunctionx]
    type = ConstantIC
    variable = streamfunction_x
    value = 0.0
  [../]
  [./streamfunctiony]
    type = ConstantIC
    variable = streamfunction_y
    value = 0.0
  [../]
[]

[Executioner]
  type = Transient
  end_time = 6e4
  start_time = 1
  solve_type = NEWTON
  nl_abs_tol = 1e-9
  l_max_its = 200
  [./TimeStepper]
    type = FunctionDT
    interpolate = false
    time_t = '0 10 500 1e3 1e4 6e4'
    time_dt = '9 10 50 100 200 200'
  [../]
[]

[Preconditioning]
  [./smp]
    type = SMP
    full = true
    petsc_options = -snes_ksp_ew
    petsc_options_iname = '-ksp_type -pc_type -pc_asm_overlap -sub_pc_type -pc_factor_levels -ksp_atol'
    petsc_options_value = 'gmres asm 10 ilu 4 1e-12'
  [../]
[]

[Outputs]
  [./console]
    type = Console
    perf_log = true
    output_nonlinear = true
    output_linear = true
  [../]
  [./exodus]
    type = Exodus
    execute_on = 'INITIAL TIMESTEP_END'
    interval = 4
  [../]
  [./csvoutput]
    type = CSV
    execute_on = 'INITIAL TIMESTEP_END'
  [../]
  [./checkpoint]
    type = Checkpoint
    num_files = 2
    interval = 10
  [../]
[]
</code></pre></div></div></body></html>